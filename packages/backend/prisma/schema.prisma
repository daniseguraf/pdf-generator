generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

generator typescriptInterfaces {
  provider = "prisma-generator-typescript-interfaces"
  output   = "../../shared/src/types/prisma.types.ts"
  prettier = true
  modelType = "type"
}

datasource db {
  provider = "postgresql"
  relationMode = "foreignKeys"
}

model Building {
  id           Int          @id @default(autoincrement())
  name         String
  description  String?      @db.Text
  yearBuilt    Int          @map("year_built")
  propertyType PropertyType @default(RESIDENTIAL) @map("property_type")
  address      String
  district     String
  city         String
  province     String
  postalCode   String?      @map("postal_code")
  floors       Int
  phoneNumber  String?      @map("phone_number")
  email        String?      @unique
  isActive     Boolean      @default(true) @map("is_active")
  createdAt    DateTime     @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt    DateTime     @updatedAt @db.Timestamptz(6) @map("updated_at")
  manager      Employee    @relation(fields: [managerId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  managerId    Int         @map("manager_id")
  // commonAreas  CommonArea[]
  // staff        Staff[]
  // units        Unit[]

  @@map("buildings")
}

model Employee {
  id        Int      @id @default(autoincrement())
  buildings  Building[]
  firstName String   @map("first_name")
  lastName  String   @map("last_name")
  phoneNumber String? @map("phone_number")
  email     String   @unique
  role      EmployeeRole @default(MANAGER)
  createdAt DateTime @default(now())  @db.Timestamptz(6) @map("created_at")
  updatedAt DateTime @updatedAt @db.Timestamptz(6) @map("updated_at")
  startDate  DateTime   @db.Timestamptz(6) @map("start_date")
  endDate    DateTime?  @db.Timestamptz(6) @map("end_date")
  isActive   Boolean    @default(true) @map("is_active")

  @@map("employees")
}

model Unit {
  id         Int        @id @default(autoincrement())
  buildingId Int       @map("building_id")
  // building   Building   @relation(fields: [buildingId], references: [id])
  number     String
  floor      Int
  type       UnitType
  status     UnitStatus
  createdAt  DateTime   @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt  DateTime   @updatedAt @db.Timestamptz(6) @map("updated_at")

  @@unique([buildingId, floor, number])
  @@index([buildingId])
  @@map("units")
}

model CommonArea {
  id          Int      @id @default(autoincrement())
  buildingId  Int      @map("building_id")
  // building    Building @relation(fields: [buildingId], references: [id])
  name        String
  description String?
  capacity    Int
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt   DateTime @updatedAt @db.Timestamptz(6) @map("updated_at")

  @@map("common_areas")
}

enum UnitType {
  APARTMENT
  OFFICE
  COMMERCIAL
}

enum UnitStatus {
  AVAILABLE
  OCCUPIED
  MAINTENANCE
}

enum EmployeeRole {
  MANAGER
  SECURITY
  CLEANER
  MAINTENANCE
  GARDENER
  RECEPTIONIST

}

enum PropertyType {
  RESIDENTIAL
  COMMERCIAL
  MIXED
}

enum UserRole {
  ADMIN
  MANAGER
  RESIDENT
  STAFF
}
